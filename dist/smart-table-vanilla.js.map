{"version":3,"file":"smart-table-vanilla.js","sources":["../node_modules/smart-table-events/index.js","../node_modules/smart-table-core/src/events.js","../node_modules/smart-table-core/src/directives/filter.js","../node_modules/smart-table-core/src/directives/search.js","../node_modules/smart-table-core/src/directives/sort.js","../node_modules/smart-table-core/src/directives/workingIndicator.js","../node_modules/smart-table-core/index.js","../lib/loadingIndicator.js","../lib/sort.js","../lib/helpers.js","../lib/filters.js","../lib/search.js","../lib/table.js"],"sourcesContent":["export function emitter () {\n\n  const listenersLists = {};\n  const instance = {\n    on(event, ...listeners){\n      listenersLists[event] = (listenersLists[event] || []).concat(listeners);\n      return instance;\n    },\n    dispatch(event, ...args){\n      const listeners = listenersLists[event] || [];\n      for (let listener of listeners) {\n        listener(...args);\n      }\n      return instance;\n    },\n    off(event, ...listeners){\n      if (!event) {\n        Object.keys(listenersLists).forEach(ev => instance.off(ev));\n      } else {\n        const list = listenersLists[event] || [];\n        listenersLists[event] = listeners.length ? list.filter(listener => !listeners.includes(listener)) : [];\n      }\n      return instance;\n    }\n  };\n  return instance;\n}\n\nexport function proxyListener (eventMap) {\n  return function ({emitter}) {\n\n    const proxy = {};\n    let eventListeners = {};\n\n    for (let ev of Object.keys(eventMap)) {\n      const method = eventMap[ev];\n      eventListeners[ev] = [];\n      proxy[method] = function (...listeners) {\n        eventListeners[ev] = eventListeners[ev].concat(listeners);\n        emitter.on(ev, ...listeners);\n        return proxy;\n      };\n    }\n\n    return Object.assign(proxy, {\n      off(ev){\n        if (!ev) {\n          Object.keys(eventListeners).forEach(eventName => proxy.off(eventName));\n        }\n        if (eventListeners[ev]) {\n          emitter.off(ev, ...eventListeners[ev]);\n        }\n        return proxy;\n      }\n    });\n  }\n}","export const TOGGLE_SORT = 'TOGGLE_SORT';\nexport const DISPLAY_CHANGED = 'DISPLAY_CHANGED';\nexport const PAGE_CHANGED = 'CHANGE_PAGE';\nexport const EXEC_CHANGED = 'EXEC_CHANGED';\nexport const FILTER_CHANGED = 'FILTER_CHANGED';\nexport const SUMMARY_CHANGED = 'SUMMARY_CHANGED';\nexport const SEARCH_CHANGED = 'SEARCH_CHANGED';\nexport const EXEC_ERROR = 'EXEC_ERROR';","import {FILTER_CHANGED} from '../events';\nimport {proxyListener} from 'smart-table-events';\n\nconst filterListener = proxyListener({[FILTER_CHANGED]: 'onFilterChange'});\n\nexport default function ({table, pointer, operator = 'includes', type = 'string'}) {\n  return Object.assign({\n      filter(input){\n        const filterConf = {\n          [pointer]: [\n            {\n              value: input,\n              operator,\n              type\n            }\n          ]\n\n        };\n        return table.filter(filterConf);\n      }\n    },\n    filterListener({emitter: table}));\n}","import {SEARCH_CHANGED} from '../events';\nimport {proxyListener} from 'smart-table-events';\n\nconst searchListener = proxyListener({[SEARCH_CHANGED]: 'onSearchChange'});\n\nexport default function ({table, scope = []}) {\n  return Object.assign(\n    searchListener({emitter: table}), {\n      search(input){\n        return table.search({value: input, scope});\n      }\n    });\n}","import {TOGGLE_SORT} from '../events'\nimport {proxyListener} from 'smart-table-events';\n\nconst sortListeners = proxyListener({[TOGGLE_SORT]: 'onSortToggle'});\nconst directions = ['asc', 'desc'];\n\nexport default function ({pointer, table, cycle = false}) {\n\n  const cycleDirections = cycle === true ? ['none'].concat(directions) : [...directions].reverse();\n\n  let hit = 0;\n\n  const directive = Object.assign({\n    toggle(){\n      hit++;\n      const direction = cycleDirections[hit % cycleDirections.length];\n      return table.sort({pointer, direction});\n    }\n\n  }, sortListeners({emitter: table}));\n\n  directive.onSortToggle(({pointer:p}) => {\n    if (pointer !== p) {\n      hit = 0;\n    }\n  });\n\n  return directive;\n}","import {EXEC_CHANGED} from '../events';\nimport {proxyListener} from 'smart-table-events';\n\nconst executionListener = proxyListener({[EXEC_CHANGED]: 'onExecutionChange'});\n\nexport default function ({table}) {\n  return executionListener({emitter: table});\n}\n","import tableDirective from './src/table';\nimport filterDirective from './src/directives/filter';\nimport searchDirective from './src/directives/search';\nimport sliceDirective from './src/directives/slice';\nimport sortDirective from './src/directives/sort';\nimport summaryDirective from './src/directives/summary';\nimport workingIndicatorDirective from './src/directives/workingIndicator';\n\nexport const search = searchDirective;\nexport const slice = sliceDirective;\nexport const summary = summaryDirective;\nexport const sort = sortDirective;\nexport const filter = filterDirective;\nexport const workingIndicator = workingIndicatorDirective;\nexport const table = tableDirective;\nexport default table;\n","import {workingIndicator} from 'smart-table-core';\n\nexport default function ({table, el}) {\n  const component = workingIndicator({table});\n  component.onExecutionChange(function ({working}) {\n    el.classList.remove('st-working');\n    if (working === true) {\n      el.classList.add('st-working');\n    }\n  });\n  return component;\n};","import {sort} from 'smart-table-core';\n\nexport default function ({el, table, conf = {}}) {\n  const pointer = conf.pointer || el.getAttribute('data-st-sort');\n  const cycle = conf.cycle || el.hasAttribute('data-st-sort-cycle');\n  const component = sort({pointer, table, cycle});\n  component.onSortToggle(({pointer:currentPointer, direction}) => {\n    el.classList.remove('st-sort-asc', 'st-sort-desc');\n    if (pointer === currentPointer && direction !== 'none') {\n      const className = direction === 'asc' ? 'st-sort-asc' : 'st-sort-desc';\n      el.classList.add(className);\n    }\n  });\n  const eventListener = ev => component.toggle();\n  el.addEventListener('click', eventListener);\n  return component;\n}","export function debounce (fn, delay) {\n  let timeoutId;\n  return (ev) => {\n    if (timeoutId) {\n      window.clearTimeout(timeoutId);\n    }\n    timeoutId = window.setTimeout(function () {\n      fn(ev);\n    }, delay);\n  };\n};","import {filter} from 'smart-table-core';\nimport {debounce} from './helpers'\n\nexport default function filterInput ({table, el, delay = 400, conf = {}}) {\n  const pointer = conf.pointer || el.getAttribute('data-st-filter');\n  const operator = conf.operator || el.getAttribute('data-st-filter-operator') || 'includes';\n  const elType = el.hasAttribute('type') ? el.getAttribute('type') : 'string';\n  let type = conf.type || el.getAttribute('data-st-filter-type');\n  if (!type) {\n    type = ['date', 'number'].includes(elType) ? elType : 'string';\n  }\n  const component = filter({table, pointer, type, operator});\n  const eventListener = debounce(ev => component.filter(el.value), delay);\n  el.addEventListener('input', eventListener);\n  if (el.tagName === 'SELECT') {\n    el.addEventListener('change', eventListener);\n  }\n  return component;\n};","import {search} from 'smart-table-core';\nimport {debounce} from './helpers';\n\nexport default function ({el, table, delay = 400, conf = {}}) {\n  const scope = conf.scope || (el.getAttribute('data-st-search') || '').split(',').map(s => s.trim());\n  const component = search({table, scope});\n  const eventListener = debounce(ev => {\n    component.search(el.value);\n  }, delay);\n  el.addEventListener('input', eventListener);\n};","import loading from './loadingIndicator';\nimport sort from  './sort';\nimport filter from './filters'\nimport searchInput from './search'\n\nexport default function ({el, table}) {\n  // boot\n  [...el.querySelectorAll('[data-st-sort]')].forEach(el => sort({el, table}));\n  [...el.querySelectorAll('[data-st-loading-indicator]')].forEach(el => loading({el, table}));\n  [...el.querySelectorAll('[data-st-search]')].forEach(el => searchInput({el, table}));\n  [...el.querySelectorAll('[data-st-filter]')].forEach(el => filter({el, table}));\n\n  //extension\n  const tableDisplayChange = table.onDisplayChange;\n  return Object.assign(table, {\n    onDisplayChange: (listener) => {\n      tableDisplayChange(listener);\n      table.exec();\n    }\n  });\n};"],"names":["executionListener","table","sort","filter"],"mappings":"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"}